@model MediCare.Models.Patient

@{
    ViewData["Title"] = "Patient Details";
    Layout = "~/Areas/Doctor/Views/Shared/_Layout.cshtml";
}

<div class="max-w-5xl mx-auto p-6 space-y-8">
    <!-- 🩺 Header -->
    <div class="flex items-center justify-between">
        <div>
            <h1 class="page-title">👤 Patient Details</h1>
            <p class="page-subtitle">View full profile information and consultation history.</p>
        </div>
        <a href="@Url.Action("Index", "Patients", new { area = "Doctor" })"
           class="btn-gray relative z-50">
            ⬅ Back to Patients
        </a>

    </div>

    <!-- 🧍 Patient Info Card -->
    <div class="card">
        <h2 class="text-lg font-semibold text-brand-800 mb-4">Personal Information</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-5 text-sm">
            <div>
                <p class="text-gray-500">Full Name</p>
                <p class="font-medium text-gray-800">@Model.AppUser?.FullName</p>
            </div>
            <div>
                <p class="text-gray-500">Email</p>
                <p class="font-medium text-gray-800">@Model.AppUser?.Email</p>
            </div>
            <div>
                <p class="text-gray-500">Phone Number</p>
                <p class="font-medium text-gray-800">@Model.PhoneNumber</p>
            </div>
            <div>
                <p class="text-gray-500">Address</p>
                <p class="font-medium text-gray-800">@Model.Address</p>
            </div>
        </div>
    </div>

    <!-- 📅 Appointment History -->
    <div class="card">
        <h2 class="text-lg font-semibold text-brand-800 mb-4">Appointment History</h2>

        @if (Model.Appointments == null || !Model.Appointments.Any())
        {
            <div class="text-gray-500 italic">No appointments recorded for this patient.</div>
        }
        else
        {
            <div class="overflow-hidden rounded-xl border border-gray-100">
                <table class="min-w-full border-collapse text-sm">
                    <thead class="bg-brand-50 text-brand-800 uppercase text-xs">
                        <tr>
                            <th class="px-4 py-3 text-left font-semibold">Date &amp; Time</th>
                            <th class="px-4 py-3 text-left font-semibold">Status</th>
                            <th class="px-4 py-3 text-left font-semibold">Notes</th>
                            <th class="px-4 py-3 text-left font-semibold">Prescription</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                        @foreach (var appt in Model.Appointments.OrderByDescending(a => a.DateTime))
                        {
                            <tr class="hover:bg-gray-50 transition">
                                <td class="px-4 py-3 text-gray-700">
                                    @appt.DateTime.ToString("dd MMM yyyy • hh:mm tt")
                                </td>
                                <td class="px-4 py-3">
                                    @{
                                        var s = appt.Status?.Trim() ?? "";
                                        var color = s switch
                                        {
                                            "Pending" => "bg-yellow-100 text-yellow-700",
                                            "Confirmed" => "bg-green-100 text-green-700",
                                            "Paid" => "bg-emerald-100 text-emerald-700",
                                            "Completed" => "bg-blue-100 text-blue-700",
                                            "Cancelled" => "bg-red-100 text-red-700",
                                            _ => "bg-gray-100 text-gray-600"
                                        };
                                    }
                                    <span class="px-3 py-1 rounded-full text-xs font-semibold @color">@s</span>
                                </td>
                                <td class="px-4 py-3 text-gray-700">
                                    @(string.IsNullOrWhiteSpace(appt.Notes) ? "—" : appt.Notes)
                                </td>
                                <td class="px-4 py-3 text-gray-700">
                                    @(string.IsNullOrWhiteSpace(appt.Prescription) ? "—" : appt.Prescription)
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</div>
