@model MediCare.Models.Appointment
@{
    ViewData["Title"] = "Appointment Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="max-w-5xl mx-auto mt-10 bg-white rounded-3xl shadow-lg p-10 border border-gray-100">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
        <h2 class="text-3xl font-bold text-blue-700 flex items-center gap-2">
            🗓 Appointment Details
        </h2>
        <a asp-action="Index"
           class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-blue-800 via-blue-600 to-cyan-400 text-white font-semibold shadow-md hover:shadow-xl hover:scale-[1.02] transition-all duration-300">
            ← Back to Appointments
        </a>
    </div>

    <!-- Details Section -->
    <div class="divide-y divide-gray-100 text-gray-700">
        <div class="pb-5">
            <h3 class="font-semibold text-gray-800 mb-1">Doctor</h3>
            <p class="font-medium">@Model.Doctor.AppUser.FullName</p>
            <p class="text-sm text-gray-500">@Model.Doctor.Specialty.Name • @Model.Doctor.Clinic?.Name</p>
        </div>

        <div class="py-5">
            <h3 class="font-semibold text-gray-800 mb-1">Date &amp; Time</h3>
            <p>@Model.DateTime.ToString("dddd, dd MMM yyyy • hh:mm tt")</p>
        </div>

        <div class="py-5">
            <h3 class="font-semibold text-gray-800 mb-1">Status</h3>
            @if (Model.Status.Equals("Pending", StringComparison.OrdinalIgnoreCase))
            {
                <span class="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-sm font-medium">Pending</span>
            }
            else if (Model.Status.Equals("Confirmed", StringComparison.OrdinalIgnoreCase))
            {
                <span class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm font-medium">Confirmed</span>
            }
            else if (Model.Status.Equals("Paid", StringComparison.OrdinalIgnoreCase))
            {
                <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium">Paid</span>
            }
            else if (Model.Status.Equals("Completed", StringComparison.OrdinalIgnoreCase))
            {
                <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium">Completed</span>
            }
            else
            {
                <span class="px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium">@Model.Status</span>
            }
        </div>

        <div class="py-5">
            <h3 class="font-semibold text-gray-800 mb-1">Fee</h3>
            <p class="text-gray-900 font-semibold">@Model.Fee.ToString("C")</p>
        </div>

        @if (Model.Payment != null)
        {
            <div class="py-5">
                <h3 class="font-semibold text-gray-800 mb-1">Payment Information</h3>
                <div class="bg-blue-50 rounded-xl p-4 border border-blue-100">
                    <p><strong>Method:</strong> @Model.Payment.Method</p>
                    <p><strong>Status:</strong> @Model.Payment.Status</p>
                    <p><strong>Transaction ID:</strong> @Model.Payment.TransactionId</p>
                </div>
            </div>
        }

        <div class="py-5">
            <h3 class="font-semibold text-gray-800 mb-2">Doctor’s Notes &amp; Prescription</h3>
            @if (!string.IsNullOrEmpty(Model.Notes) || !string.IsNullOrEmpty(Model.Prescription))
            {
                @if (!string.IsNullOrEmpty(Model.Notes))
                {
                    <div class="bg-gray-50 border border-gray-100 p-5 rounded-xl mb-3 shadow-sm">
                        <h4 class="font-semibold text-blue-700 mb-2">📝 Consultation Notes</h4>
                        <p class="text-gray-700 leading-relaxed whitespace-pre-line">@Model.Notes</p>
                    </div>
                }

                @if (!string.IsNullOrEmpty(Model.Prescription))
                {
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-100 p-5 rounded-xl shadow-sm">
                        <h4 class="font-semibold text-blue-700 mb-2">💊 Prescription</h4>
                        <p class="text-gray-700 leading-relaxed whitespace-pre-line">@Model.Prescription</p>
                    </div>
                }
            }
            else
            {
                <div class="bg-gray-50 border border-gray-100 p-4 rounded-lg text-gray-500 italic">
                    Doctor’s notes and prescription are not yet available.
                </div>
            }
        </div>
    </div>

    <!-- Footer Buttons -->
    <div class="mt-10 flex flex-wrap justify-between items-center gap-4">
        <a asp-action="Index"
           class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-gray-200 via-gray-100 to-white text-gray-700 font-semibold border border-gray-300 shadow-sm hover:shadow-md hover:scale-[1.02] transition-all duration-300">
            ← Back to Appointments
        </a>

        <div class="flex gap-3">
            @if (Model.Status.Equals("Paid", StringComparison.OrdinalIgnoreCase))
            {
                <a asp-action="DownloadReceipt"
                   asp-route-id="@Model.AppointmentId"
                   class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-emerald-700 via-emerald-500 to-teal-400 text-white font-semibold shadow-md hover:shadow-xl hover:scale-[1.02] transition-all duration-300">
                    🧾 Download Receipt
                </a>
            }
            else if (Model.Status.Equals("Completed", StringComparison.OrdinalIgnoreCase) && !string.IsNullOrEmpty(Model.Prescription))
            {
                <a asp-action="DownloadPrescription"
                   asp-route-id="@Model.AppointmentId"
                   class="px-5 py-2.5 rounded-xl bg-gradient-to-r from-blue-800 via-blue-600 to-cyan-400 text-white font-semibold shadow-md hover:shadow-xl hover:scale-[1.02] transition-all duration-300">
                    💊 Download Prescription
                </a>
            }
        </div>
    </div>
</div>
